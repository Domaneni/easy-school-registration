jQuery(function($){$(document).ready(function(){if($(".esr-schedule-calendar").length>0){var a=$(".esr-schedule-calendar").first().data("wave-id");$('.esr-group-filter[data-wave="'+a+'"], .esr-level-filter[data-wave="'+a+'"]').show()}$(".esr-choosed-courses .esr-course-row").length>0&&($(".esr-choosed-courses .esr-course-row").each(function(d,b){var c=$(b).data("course"),a=$('.esr-course[data-id="'+c+'"]');a.removeClass("esr-add").addClass("esr-remove"),1===$(".esr-course-registration-form").data("showGroups")&&$(".esr-choosed-courses .esr-group.wave_"+a.data("wave")+" .esr-group-content .esr-group-"+a.data("group")+" .esr-group-header").show(),0==a.data("leader-enabled")&&$(".esr-choosed-courses .esr-group .course-"+a.data("id")).find('select option[value="0"]').remove(),0==a.data("follower-enabled")&&$(".esr-choosed-courses .esr-group .course-"+a.data("id")).find('select option[value="1"]').remove(),a.data("solo-enabled")&&$(".esr-choosed-courses .esr-group .course-"+a.data("id")+"  .registration-info .esr-info-row").remove()}),i($(this).closest(".esr-registration-form-container")));let c=$(".esr-textarea-limit");function g(a,b){b?a.hide():a.css("opacity",.4)}function h(a,b){b?a.show():a.css("opacity",1)}function i(a){var b=0;k($(a).find(".esr-schedules .esr-halls-schedule .esr-remove")).each(function(){b+=Number($(this).data("price"))});var c=$(a).find(".esr-choosed-courses").data("price-template");b>0?(b=l(a,b),$(a).find(".esr-total-price-count").data("total-price",b).text(c.replace("[price]",b))):$(a).find(".esr-total-price-count").data("total-price",0).text("")}function j(a,c){var b=0;k($(a).find('.esr-schedules .esr-halls-schedule .esr-remove[data-wave="'+c+'"]')).each(function(){b+=Number($(this).data("price"))});var d=$(a).find(".esr-choosed-courses").data("price-template");b>0?(b=l(a,b),$(a).find(".esr-group.wave_"+c+" .esr-wave-price .esr-wave-price-count").data("wave-price",b).text(d.replace("[price]",b))):$(a).find(".esr-group.wave_"+c+" .esr-wave-price .esr-wave-price-count").data("wave-price",0).text("")}function k(a){var b={};return a.filter(function(){var a=$(this).data("id");return!b[a]&&(b[a]=!0,!0)})}function l(b,a){return 1==$(".esr-course-registration-form",b).data("round-payments")?a.toFixed(0):a%1!=0?a.toFixed(2):a}function f(){$(".esr-schedules .schedule-by-day.esr-schedule-calendar").each(function(){var b=$(this).is(":visible"),a=0,c=$(this).closest(".esr-schedules");$(this).find(".esr-row").each(function(c){b?a+=parseInt($(this).outerWidth(),10):a+=parseInt($(this).actual("outerWidth"),10)}),0!==a&&$(this).css("width",a),m(c,$(this),a,b)}),$(".esr-schedules .schedule-by-hours.esr-schedule-calendar, .esr-schedules .schedule-by-hours-compact.esr-schedule-calendar").each(function(){var a=$(this).is(":visible"),d=0,b=0,c=$(this).closest(".esr-schedules");$(this).find(".esr-row").each(function(f,e){$(e).find(".esr-day-hall-schedule").each(function(f,b){var c=0;$(b).find(" > *").each(function(d,b){a?c+=$(b).outerWidth():c+=$(b).actual("outerWidth")}),$(b).css("width",c),d<c&&(d=c);var e=Math.max.apply(null,$(b).find(".esr-course").map(function(){var b=jQuery(this)[0].scrollHeight+2;return(a?jQuery(this).height:jQuery(this).actual("height"))>=b?0:b}).get());e>0&&($(b).css("height",e),$(b).find(".esr-course, .esr-hall").css("height",e))});var c=0;b<(c=a?parseInt($(e).find(".esr-day").outerWidth(),10)+d:parseInt($(e).find(".esr-day").actual("outerWidth"),10)+d)&&(b=c),0!==c&&$(this).css("width",c)}),m(c,$(this),b,a)})}function m(a,c,b,e){if(a.hasClass("esr-automatic-zoom")&&0!==b){e?c.css("transform","scale("+a.parent().outerWidth()/b+")").css("transform-origin","0 0").css("-moz-transform","scale("+a.parent().outerWidth()/b+")").css("-moz-transform-origin","0 0"):c.css("transform","scale("+a.parent().actual("outerWidth")/b+")").css("transform-origin","0 0").css("-moz-transform","scale("+a.parent().actual("outerWidth")/b+")").css("-moz-transform-origin","0 0"),a.closest(".esr-schedule-wrapper").css("overflow","hidden");var d=0;c.find(".esr-row").each(function(a){d+=parseFloat($(this)[0].getBoundingClientRect().width)}),d>b&&c.css("width",Math.ceil(d))}}function n(a,b){a.stop(),$(".spinner-bg",b).hide()}if(c.length>0&&($.each(c,function(c,a){let b=$(a).find("textarea").attr("maxlength");$(a).append("<span class='esr-area-limit'><span class='actual'>0</span><span class='max'> / "+b+"</span></span>")}),$("body").on("keyup paste",".esr-textarea-limit textarea",function(){$(this).next(".esr-area-limit").find(".actual").text($(this).val().length)})),$("body").on("click",".esr-add",function(){var b=$(this).closest(".esr-registration-form-container"),e=$(this).closest(".esr-schedules, .esr-schedules-mobile"),a=$(this),f=$(b).find(".esr-course[data-id="+a.data("id")+"]"),c=$(b).find(".esr-prep-form-row").html();if(c=(c=(c=(c=c.replace(/%course-name%/g,a.find(".esr-title").text())).replace(/%course-price%/g,a.data("price"))).replace(/%course-id%/g,a.data("id"))).replace(/%course-wave%/g,a.data("wave")),$multipleDaysCourses=$(".esr-course[data-id='"+a.data("id")+"']",e),1===$multipleDaysCourses.length)c=(c=""!==a.data("day")?c.replace(/%course-day%/g,a.data("day")+" - "):c.replace(/%course-day%/g,a.data("day"))).replace(/%course-start%/g,a.data("start"));else{var g="";$.each($multipleDaysCourses,function(b,a){""!==g&&(g+="<br>"),""!==$(a).data("day")?g+=$(a).data("day")+" - ":g+=$(a).data("day"),g+=$(a).data("start")}),c=c.replace(/%course-day% %course-start%/g,g)}if(f.removeClass("esr-add").addClass("esr-remove"),1===$(b).find(".esr-course-registration-form").data("showGroups")?($(b).find(".esr-choosed-courses .esr-group.wave_"+a.data("wave")+" .esr-group-content .esr-group-"+a.data("group")+" .esr-group-header").show(),$(b).find(".esr-choosed-courses .esr-group.wave_"+a.data("wave")+" .esr-group-content .esr-group-"+a.data("group")+" .esr-sub-group-content").append(c)):$(b).find(".esr-choosed-courses .esr-group.wave_"+a.data("wave")+" .esr-group-content").append(c),0==a.data("leader-enabled")&&$(b).find(".esr-choosed-courses .esr-group .course-"+a.data("id")).find('select option[value="0"]').remove(),0==a.data("follower-enabled")&&$(b).find(".esr-choosed-courses .esr-group .course-"+a.data("id")).find('select option[value="1"]').remove(),a.data("solo-enabled")&&$(b).find(".esr-choosed-courses .esr-group .course-"+a.data("id")+"  .registration-info .esr-info-row").remove(),a.data("enforce-partner")){$(b).find(".esr-choosed-courses .esr-group .course-"+a.data("id")+" .esr-row-choose-partner").remove();var d=$(b).find(".esr-choosed-courses .esr-group .course-"+a.data("id")+" .esr-row-dancing-with");d.show(),d.find(".esr-info-row-input.esr-dancing-with").prop("required",!0)}i(b),j(b,a.data("wave"))}).on("click",".esr-remove",function(){var b=$(this).closest(".esr-registration-form-container"),a=$(this),d=$(b).find(".esr-course[data-id="+a.data("id")+"]");$(b).find('.esr-choosed-courses div[data-course="'+a.data("id")+'"]').remove(),d.removeClass("esr-remove").addClass("esr-add");var c=$(".esr-choosed-courses .esr-group.wave_"+a.data("wave")+" .esr-group-content .esr-group-"+a.data("group"));0===c.find(".esr-sub-group-content .esr-course-row").length&&c.find(".esr-group-header").hide(),i(b),j(b,a.data("wave"))}).each(function(){0===$(this).find(".esr-hall").length&&$(this).find(".esr-header .esr-hall-header").hide()}).on("change",".esr-filter-schedule",function(){var b=$(this).attr("name"),a=$(this).val();$(".esr-schedule-calendar").hide(),$(".esr-schedule-calendar[data-"+b+"="+a+"]").show(),$(".esr-group-filter, .esr-level-filter").hide(),$('.esr-group-filter[data-wave="'+a+'"], .esr-level-filter[data-wave="'+a+'"]').show(),f()}).on("change","input.choose_partner",function(){if($(this).is(":checked")){var a=$(this).closest(".esr-info-row").next();"0"===$(this).val()?(a.hide(),a.find(".esr-info-row-input.esr-dancing-with").prop("required",!1)):(a.show(),a.find(".esr-info-row-input.esr-dancing-with").prop("required",!0))}}).on("submit","form.esr-course-registration-form",function(f){f.preventDefault();var b,c,a=$(this),e=a.parent();$(".esr-error").remove();var d={},g=(b=e,c=new Spinner({lines:12,length:30,width:17,radius:45,scale:1,corners:1,color:"#ffffff",fadeColor:"transparent",speed:.7,rotate:0,animation:"spinner-line-fade-quick",direction:1,zIndex:2e9,className:"spinner",top:"80%",left:"50%",shadow:"0 0 1px transparent",position:"absolute"}).spin(),$(".spinner-bg",b).show(),$(b).append(c.el),c);if($("input[name=esr-registration-submitted]",a).prop("disabled",!0),d.courses={},function(b){if(b.find(".esr-user-form input.esr-confirm-email").length>0){var c=b.find(".esr-user-form input[name=email]"),a=b.find(".esr-user-form input.esr-confirm-email"),d=c.val().trim()!==a.val().trim();d&&($(c).parent().append('<div class="esr-error">'+$(a).data("error-message")+"</div>"),$(a).parent().append('<div class="esr-error">'+$(a).data("error-message")+"</div>"))}}(a),a.find(".esr-choosed-courses .esr-course-row").length>0){a.find(".esr-choosed-courses .esr-course-row").each(function(c,a){var b=$(a).data("course");d.courses[b]={},d.courses[b].course_id=b,0!==$(a).find(".esr-dancing-as").length&&(d.courses[b].dancing_as=$(a).find(".esr-dancing-as").val()),0!==$(a).find(".choose_partner").length&&(d.courses[b].choose_partner=$(a).find(".choose_partner:checked").val()),0!==$(a).find(".esr-dancing-with").length&&(d.courses[b].dancing_with=$(a).find(".esr-dancing-with").val())}),d.user_info={},a.find(".esr-user-form input:not(.esr-confirm-email), .esr-user-form select, .esr-user-form textarea").each(function(c,a){var b=$(a).val();"checkbox"===$(a).attr("type")&&(b=$(a).prop("checked")),d.user_info[$(a).attr("name")]=b}),a.find(".esr-other-inputs input, .esr-other-inputs select, .esr-other-inputs textarea").each(function(c,a){var b=$(a).val();"checkbox"===$(a).attr("type")&&(b=$(a).prop("checked")),d.user_info[$(a).attr("name")]=b});var h={action:"esr_process_registration",registration_data:JSON.stringify(d)};$.post(esr_ajax_object.ajaxurl,h,function(a){}).done(function(b){b.hasOwnProperty("thank_you_text")?(a.find(".esr-choosed-courses").remove(),a.remove(),n(g,e),e.find(".esr-schedule-wrapper").empty().append(b.thank_you_text),$("html, body").animate({scrollTop:$(".esr-thank-you",e).offset().top-50},2e3)):b.hasOwnProperty("errors")&&($.each(b.errors.errors,function(d,c){var b=d.split(".");"user_info"===b[0]?a.find("[name="+b[1]+"]").after('<div class="esr-error">'+c[0]+"</div>"):"courses"===b[0]&&("all"===b[1]?a.find(".esr-choosed-courses .esr-group-content").append('<div class="esr-error">'+c[0]+"</div>"):a.find(".esr-choosed-courses .esr-course-row[data-course="+b[1]+"]").append('<div class="esr-error">'+c[0]+"</div>"))}),$("html, body").animate({scrollTop:a.find(".esr-choosed-courses").offset().top-50},2e3),n(g,e),$("input[name=esr-registration-submitted]",a).prop("disabled",!1))})}else a.find(".esr-choosed-courses .esr-group-content").append("<div class='esr-error'>"+a.data("no-courses")+"</div>"),$("html, body").animate({scrollTop:a.find(".esr-choosed-courses").offset().top-50},2e3),n(g,e),$("input[name=esr-registration-submitted]",a).prop("disabled",!1)}).on("click",".esr-group-filter-button",function(){var b=$(this).closest(".esr-group-filter");$(".esr-group-filter-button",b).removeClass("esr-group-filter-active"),$(this).addClass("esr-group-filter-active");var a=$(".esr-schedule-calendar[data-wave-id="+$(b).data("wave")+"]",$(this).closest(".esr-schedule-wrapper")),c=$(this).data("group-id"),d=$(b).hasClass("esr-group-filter-hide");h(a.find(".esr-course:not(.esr-empty), .esr-day-hall-schedule, .esr-halls-schedule"),d),"all"!==c&&(g(a.find(".esr-course:not([data-group="+c+"]):not(.esr-empty)"),d),$.each(a.find(".esr-day-hall-schedule"),function(b,a){0===$(a).find(".esr-course:not(.esr-empty):visible").length&&g($(a),d)}),$.each(a.find(".esr-halls-schedule"),function(b,a){0===$(a).find(".esr-day-hall-schedule:visible").length&&g($(a),d)}))}).on("click",".esr-level-filter-button",function(){var b=$(this).closest(".esr-level-filter"),a=$(".esr-schedule-calendar[data-wave-id="+$(b).data("wave")+"]",$(this).closest(".esr-schedule-wrapper")),c=$(this).data("level-id"),d=$(b).hasClass("esr-level-filter-hide");h(a.find(".esr-course:not(.esr-empty), .esr-day-hall-schedule, .esr-halls-schedule"),d),"all"!==c&&(g(a.find(".esr-course:not([data-level="+c+"]):not(.esr-empty)"),d),$.each(a.find(".esr-day-hall-schedule"),function(b,a){0===$(a).find(".esr-course:not(.esr-empty):visible").length&&g($(a),d)}),$.each(a.find(".esr-halls-schedule"),function(b,a){0===$(a).find(".esr-day-hall-schedule:visible").length&&g($(a),d)}))}),$("#esr-thank-you").length>0&&($("#ui-accordion-1-header-0 a").click(),$("html, body").animate({scrollTop:$("#esr-thank-you").offset().top},2e3)),$("#esr-errors").length>0&&($("#ui-accordion-1-header-0 a").click(),$("html, body").animate({scrollTop:$("#esr-errors").offset().top},2e3)),$(".esr-schedules .esr-schedule-calendar").length>0&&f(),$(".esr-schedule-calendar").length>0){var a=$(".esr-schedule-calendar").first().data("wave-id");if($('.esr-group-filter[data-wave="'+a+'"], .esr-level-filter[data-wave="'+a+'"]').show(),window.location.search.substring(1).indexOf("esr_group_preload")>=0){var d,b,e=window.location.search.substring(1).split("&");for(b=0;b<e.length;b++)"esr_group_preload"===(d=e[b].split("="))[0]&&$(".esr-group-filter-button[data-group-id='"+decodeURIComponent(d[1])+"']").trigger("click")}}})}),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){a.fn.addBack=a.fn.addBack||a.fn.andSelf,a.fn.extend({actual:function(b,g){if(!this[b])throw'$.actual => The jQuery method "'+b+'" you called does not exist';var c=a.extend({absolute:!1,clone:!1,includeMargin:!1,display:"block"},g),d=this.eq(0);if(!0===c.clone)e=function(){var a="position: absolute !important; top: -1000 !important; ";d=d.clone().attr("style",a).appendTo("body")},f=function(){d.remove()};else{var e,f,i,j=[],k="";e=function(){i=d.parents().addBack().filter(":hidden"),k+="visibility: hidden !important; display: "+c.display+" !important; ",!0===c.absolute&&(k+="position: absolute !important; "),i.each(function(){var c=a(this),b=c.attr("style");j.push(b),c.attr("style",b?b+";"+k:k)})},f=function(){i.each(function(d){var b=a(this),c=j[d];void 0===c?b.removeAttr("style"):b.attr("style",c)})}}e();var h=/(outer)/.test(b)?d[b](c.includeMargin):d[b]();return f(),h}})})