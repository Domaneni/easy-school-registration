jQuery((function(e){e(document).ready((function(){window["moment-range"].extendMoment(moment),0!==e(".esr-question").length&&tippy(".esr-question",{interactive:!0,content:e=>e.getAttribute("title")}),0===e("body").find(".esr-hall").size()&&e("body").find(".esr-header .esr-hall-header").hide();var t=!0;if(e(document).on("click",".esr-row .actions button",(function(){e(this).next().is(":visible")?e(this).next().hide():(e(".esr-actions-box").hide(),e(this).next().show(),t=!1)})).on("click",".actions.esr-course .esr-action.remove-forever",(function(){if(!0===confirm("Do you really want to completely delete this course with statistics and registrations?")){var t=e(this).closest(".esr-row"),a={action:"esr_remove_course_forever",course_id:t.data("id")};e.post(ajaxurl,a,(function(e){"-1"!==e&&t.remove()}))}})).on("click",".actions.esr-course .esr-action.deactivate",(function(){var t=e(this).closest(".esr-row"),a={action:"esr_set_course_passed",course_id:t.data("id")};e.post(ajaxurl,a,(function(e){"-1"!==e&&(t.addClass("passed"),t.find(".esr_course_status").text(e.status))}))})).on("click",".actions.esr-course .esr-action.activate",(function(){var t=e(this).closest(".esr-row"),a={action:"esr_set_course_active",course_id:t.data("id")};e.post(ajaxurl,a,(function(e){"-1"!==e&&(t.removeClass("passed"),t.find(".esr_course_status").text(e.status))}))})).on("click","body",(function(){t&&e(".esr-actions-box").hide(),t=!0})).on("change","[name=is_solo]",(function(){e(this).is(":checked")?(e(".hide_solo").hide(),e(".show_solo").show()):(e(".hide_solo").show(),e(".show_solo").hide())})).on("click",".default-times a",(function(t){t.preventDefault();var a=e(this).parent().parent().parent();e("input.esr-time-from",a).val(e(this).data("time-from")),e("input.esr-time-to",a).val(e(this).data("time-to"))})).on("click",".esr-add-new-day",(function(){var t=e(this).parent().parent(),a=e(t).clone();e(a).find("select").val(""),e(a).find("input").val(null);var n=Math.floor(26*Math.random())+Date.now();e(a).data("name",n),e(a).find("select, input").each((function(a){var s=e(this).attr("name");s=s.replace(t.data("name"),n),e(this).attr("name",s)})),e(t).parent().append(e(a))})).on("click",".esr-remove-new-day",(function(){e(this).parent().parent().remove()})).on("change","select[name=hall_key]",(function(){if(""!==e(this).val()){var t=e(this).find("option[value="+e(this).val()+"]");e("input[name=max_solo]").val(e(t).data("solo")),e("input[name=max_leaders], input[name=max_followers]").val(e(t).data("couples"))}})).on("change","input[name=course_from]",(function(){e("input[name=course_to]").attr("min",e(this).val())})),e("select[name='wave_id'] option[data-course-from][data-course-to]").length>0){function a(){if(""!==e("select[name='day']").val()){var t=e(".esr-edit-form"),a=e("select[name='wave_id']",t).val();if(""!==a){var n=e("select[name='wave_id'] option[value="+a+"]",t),s=e("select[name='day']",t).val();if(""!==e("select[name='wave_id']",t).val()){var o=n.data("course-from"),i=n.data("course-to");if(void 0!==o&&void 0!==i){var r=new Date(o);r.setDate(r.getDate()+((7-r.getDay())%7+parseInt(s))%7);var l=moment(o),c=moment(i),d=moment.rangeFromInterval("week",c.diff(l,"weeks"),moment(r));e("input[name='course_from']",t).val(d.start.format("YYYY-MM-DD")),e("input[name='course_to']",t).val(d.end.format("YYYY-MM-DD"))}}}}}e("body").on("change",".esr-edit-form :not(.esr-course-days) select[name='day']",(function(){a()})).on("change",".esr-edit-form select[name='wave_id']",(function(){a()}))}}))})),jQuery((function(e){e(document).ready((function(){e(".esr-datatable:not(.esr-all-false)").length?e.each(e(".esr-datatable:not(.esr-all-false)"),(function(t,a){var n={lengthMenu:[[25,50,100,200,-1],[25,50,100,200,"All"]],pageLength:100,order:[[0,"desc"]],aoColumnDefs:[{bSortable:!1,aTargets:["no-sort"]}],dom:"lBfrtip",buttons:["colvis"],columnDefs:[{targets:"no-sort",orderable:!1}],initComplete:function(){this.api().columns().every((function(){var t=this,a=e(t.header()).hasClass("esr-multiple-filters");if(e(t.header()).data("label",e(t.header()).text()),!e(t.header()).hasClass("esr-filter-disabled")){var n=e('<select><option value="">'+e(t.header()).text()+"</option></select>").appendTo(e(t.header()).empty()).on("change",(function(){var n=e.fn.dataTable.util.escapeRegex(e(this).val());a?t.search(n?n+"+":"",!0,!1).draw():t.search(n?"^"+n+"$":"",!0,!1).draw()})),s=[];t.data().unique().sort().each((function(t){a?e.each(t.split(", "),(function(t,a){""!==a&&-1===e.inArray(a,s)&&(n.append('<option value="'+a+'">'+a+"</option>"),s.push(a))})):""!==t&&n.append('<option value="'+t+'">'+t+"</option>")}))}})),e("[data-cin-course-id]").length>0&&jQuery("th.course select option").filter((function(){return 0===jQuery(this).text().indexOf(e("[data-cin-course-id]").data("cin-course-id")+" - ")})).prop("selected",!0).trigger("change")}};e(a).hasClass("esr-email-export")&&n.buttons.push({extend:"copyHtml5",text:"Copy Emails",title:"",header:!1,exportOptions:{columns:[".esr-student-email:visible:not(.esr-hide-print)"],customizeData:function(t){var a=[],n=[];e.each(t.body,(function(t,s){-1===e.inArray(s[0],n)&&(a.push(s),n.push(s[0]))})),t.body=a}}}),e(a).hasClass("esr-newsletter-email-export")&&n.buttons.push({extend:"copyHtml5",text:"Copy newsletter emails",title:"",header:!1,exportOptions:{columns:[".esr-student-email:visible:not(.esr-hide-print)"],rows:[".esr-has-newsletter"],customizeData:function(t){var a=[],n=[];e.each(t.body,(function(t,s){-1===e.inArray(s[0],n)&&(a.push(s),n.push(s[0]))})),t.body=a}}}),e(a).hasClass("esr-copy-table")&&n.buttons.push({extend:"copyHtml5",text:"Copy Table",title:"",exportOptions:{columns:[":visible:not(.esr-hide-print)"],format:{header:function(t,a,n,s){return e(n).data("label")}}}}),e(a).hasClass("esr-excel-export")&&n.buttons.push({extend:"excel",text:"Excel",title:"",exportOptions:{columns:[":visible:not(.esr-hide-print)"],format:{header:function(t,a,n,s){return e(n).data("label")}}}}),e(a).hasClass("esr-enable-scroll")&&(n.scrollX=!0,n.scrollCollapse=!0,n.fixedColumns=!0,n.columnDefs.push({width:"20%",targets:0})),"undefined"!==e(a).data("idisplaylengt")&&(n.iDisplayLength=e(a).data("idisplaylengt"));var s=e(a).DataTable(n);e(a).hasClass("esr-enable-scroll")&&s.columns.adjust().draw(),e("[data-cin-student-id]").length>0&&jQuery(".dataTables_filter input[type=search]").val(e("[data-cin-student-id]").data("cin-student-id")).trigger("keyup")})):e(".esr-datatable.esr-all-false").length&&e(".esr-datatable.esr-all-false").DataTable({bFilter:!1,bInfo:!1,bPaginate:!1,bLength:!1,bSort:!1})}))}));